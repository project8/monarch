

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Egg v3.1.0 File Standard &mdash; Monarch 3.2.4 documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Monarch 3.2.4 documentation" href="index.html"/>
        <link rel="up" title="EggStandards" href="Monarch_versions.html"/>
        <link rel="next" title="Egg v3.2.0 File Standard" href="EggStandard.v3.2.0.html"/>
        <link rel="prev" title="Egg v3.0.0 File Standard" href="EggStandard.v3.0.0.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="index.html" class="icon icon-home"> Monarch
        

        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="Monarch_versions.html">EggStandards</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="EggStandard.v1.html">Egg v1 File Standard</a><ul>
<li class="toctree-l3"><a class="reference internal" href="EggStandard.v1.html#file-structure">File Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="EggStandard.v1.html#prelude">Prelude</a></li>
<li class="toctree-l3"><a class="reference internal" href="EggStandard.v1.html#header">Header</a></li>
<li class="toctree-l3"><a class="reference internal" href="EggStandard.v1.html#record">Record</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="EggStandard.v2.html">Egg v2 File Standard</a><ul>
<li class="toctree-l3"><a class="reference internal" href="EggStandard.v2.html#file-structure">File Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="EggStandard.v2.html#prelude">Prelude</a></li>
<li class="toctree-l3"><a class="reference internal" href="EggStandard.v2.html#header">Header</a></li>
<li class="toctree-l3"><a class="reference internal" href="EggStandard.v2.html#record">Record</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="EggStandard.v3.0.0.html">Egg v3.0.0 File Standard</a><ul>
<li class="toctree-l3"><a class="reference internal" href="EggStandard.v3.0.0.html#file-structure">File Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="EggStandard.v3.0.0.html#file-attributes">File Attributes</a></li>
<li class="toctree-l3"><a class="reference internal" href="EggStandard.v3.0.0.html#stream-attributes">Stream Attributes</a></li>
<li class="toctree-l3"><a class="reference internal" href="EggStandard.v3.0.0.html#channel-attributes">Channel Attributes</a></li>
<li class="toctree-l3"><a class="reference internal" href="EggStandard.v3.0.0.html#acquisitions">Acquisitions</a></li>
<li class="toctree-l3"><a class="reference internal" href="EggStandard.v3.0.0.html#known-issues">Known Issues</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Egg v3.1.0 File Standard</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#file-structure">File Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="#file-attributes">File Attributes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#stream-attributes">Stream Attributes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#channel-attributes">Channel Attributes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#acquisitions">Acquisitions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#known-issues">Known Issues</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="EggStandard.v3.2.0.html">Egg v3.2.0 File Standard</a><ul>
<li class="toctree-l3"><a class="reference internal" href="EggStandard.v3.2.0.html#file-structure">File Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="EggStandard.v3.2.0.html#file-attributes">File Attributes</a></li>
<li class="toctree-l3"><a class="reference internal" href="EggStandard.v3.2.0.html#stream-attributes">Stream Attributes</a></li>
<li class="toctree-l3"><a class="reference internal" href="EggStandard.v3.2.0.html#channel-attributes">Channel Attributes</a></li>
<li class="toctree-l3"><a class="reference internal" href="EggStandard.v3.2.0.html#acquisitions">Acquisitions</a></li>
<li class="toctree-l3"><a class="reference internal" href="EggStandard.v3.2.0.html#known-issues">Known Issues</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="UsageMonarch3.html">How to use Monarch3</a><ul>
<li class="toctree-l2"><a class="reference internal" href="UsageMonarch3.html#reading-egg3-files">Reading Egg3 Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="UsageMonarch3.html#writing-egg3-files">Writing Egg3 Files</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="from_doxygen.html">Full Doxygen Reference</a></li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Monarch</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
          <li><a href="Monarch_versions.html">EggStandards</a> &raquo;</li>
      
    <li>Egg v3.1.0 File Standard</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/EggStandard.v3.1.0.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="egg-v3-1-0-file-standard">
<h1>Egg v3.1.0 File Standard<a class="headerlink" href="#egg-v3-1-0-file-standard" title="Permalink to this headline">¶</a></h1>
<p>Usage history:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">1/2015:</th><td class="field-body"><ul class="first simple">
<li>First version</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">5/8/2015:</th><td class="field-body"><ul class="first simple">
<li>v3.0.0 finalized</li>
</ul>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">11/19/2015:</th><td class="field-body"><ul class="first last simple">
<li>v3.1.0 finalized &#8211; Added Bit Alignment</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Relevant software:</p>
<ul class="simple">
<li>Monarch v3</li>
</ul>
<p>Files are written in HDF5 format.
All group, dataset, and attribute names are lower case, with words separated by underscores.
Numerical values in the file are stored in little-endian format.</p>
<div class="section" id="file-structure">
<h2>File Structure<a class="headerlink" href="#file-structure" title="Permalink to this headline">¶</a></h2>
<p>Version 3 egg files are designed to accept data from multiple sources that may or may not
be taking data in a synchronized way.  It is also can also record both integer and floating-point data.</p>
<p>Data from each source are divided into <em>acquisitions</em> and <em>records</em>.
A <em>record</em> consists of a set number of data samples.
An <em>acquisition</em> is the set of records that are contiguous in time.</p>
<p>A single source of data (e.g. a digitizer channel) is called a <em>channel</em> in the egg file.
However, some devices produce data from multiple channels combined together;
therefore data are actually recorded in the egg file in <em>streams</em>,
where each stream contains one or more channel of data.</p>
<p>In a stream with multiple channels, the individual samples from each channel can either be <em>separate</em> or <em>interleaved</em>.
For example, one record of data from a device with two channels, A and B,
recorded separately in a single stream would look like this in the stream:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">AAAAABBBBB</span>
</pre></div>
</div>
<p>One record of data from a device with two channels, C and D,
recorded interleaved in a single stream would look like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">CDCDCDCDCD</span>
</pre></div>
</div>
<p>In these cases, the record length for each channel is 5, and the record length for each stream is 10.</p>
<p>Header information describing the run is stored in the file attributes.
Channel and stream header information is stored in the attributes for each channel and stream group.</p>
<div class="highlight-python"><div class="highlight"><pre>File (w/ attr)
|
+-- channels (group)
|   |
|   +-- channel0 (group w/ attr)
|   |
|   +-- channel1 (group w/ attr)
|   |
|   +-- . . .
|
+-- streams (group)
    |
    +-- stream0 (group w/ attr)
    |   |
    |   +-- acquisitions (group)
    |       |
    |       +-- 0 (dataset w/ attr)
    |       |
    |       +-- 1 (dataset w/ attr)
    |       |
    |       +-- . . .
    |
    +-- stream1 (group w/ attr)
        |
        +-- acquisitions (group)
            |
            +-- 0 (dataset w/ attr)
            |
            +-- 1 (dataset w/ attr)
            |
            +-- . . .
</pre></div>
</div>
</div>
<div class="section" id="file-attributes">
<h2>File Attributes<a class="headerlink" href="#file-attributes" title="Permalink to this headline">¶</a></h2>
<p>These attributes constitute the header for the file, and describe its contents.
They consist of information that apply to the all streams and channels.</p>
<ul class="simple">
<li>egg_version (string) &#8211; Egg file version</li>
<li>filename (string) &#8211; Filename</li>
<li>run_duration (uint32) &#8211; Length of the run in ms</li>
<li>timestamp (string) &#8211; Timestamp string</li>
<li>description (string) &#8211; Description of the run</li>
<li>n_channels (uint32) &#8211; Number of channels present</li>
<li>n_streams (uint32) &#8211; Number of streams used</li>
<li>channel_streams (vector&lt; uint32 &gt;) &#8211; Map of channel number to stream number</li>
<li>channel_coherence (vector&lt; vector&lt; bool &gt; &gt;) &#8211; Matrix of channel coherence (stored as uint8_t)</li>
</ul>
</div>
<div class="section" id="stream-attributes">
<h2>Stream Attributes<a class="headerlink" href="#stream-attributes" title="Permalink to this headline">¶</a></h2>
<p>Each stream group has a set of attributes needed to fully describe the stream.
Information there is common to all of the channels included in that stream.</p>
<ul class="simple">
<li>number (uint32) &#8211; Sequential integer used to uniquely identify each stream in the file; the stream&#8217;s group will be named &#8220;stream[Number]&#8221;.</li>
<li>source (string) &#8211; Device used to produce the stream</li>
<li>n_channels (uint32) &#8211; Number of channels in the stream</li>
<li>channels (vector&lt; uint32 &gt;) &#8211; Global channel numbers for the channels in this stream</li>
<li>channel_format (uint32) &#8211; Whether the samples from multiple channels are interleaved or separate (either is valid for single-channel streams)<ul>
<li>0 == interleaved</li>
<li>1 == separate</li>
</ul>
</li>
<li>acquisition_rate (uint32) &#8211; Acquisition rate in MHz</li>
<li>record_size (uint32) &#8211; Number of samples in each channel record (stream record size = # channels * record size)</li>
<li>data_type_size (uint32) &#8211; Number of bytes used to represent each sample (whether integer or floating point)</li>
<li>data_format_type (uint32) &#8211; Whether the data is analog or digitized<ul>
<li>0 == digitized</li>
<li>1 == analog</li>
</ul>
</li>
<li>bit_depth (uint32) &#8211; Number of bits with which the data was digitized</li>
<li>bit_alignment (uint32) &#8211; Whether the bits within each sample are left-aligned or right-aligned within the sample data word (if the bit depth is less that the data type size)<ul>
<li>0 == left-aligned</li>
<li>1 == right-aligned</li>
</ul>
</li>
<li>n_acquisitions (uint32) &#8211; Number of acquisitions recorded</li>
<li>n_records (uint32) &#8211; Number of records recorded</li>
</ul>
</div>
<div class="section" id="channel-attributes">
<h2>Channel Attributes<a class="headerlink" href="#channel-attributes" title="Permalink to this headline">¶</a></h2>
<p>While much of the information regarding multiple channels in a single stream
will be the same for all of those channels, some can certainly be different.
Therefore each channel is given its own header information.</p>
<p>Some information is duplicated between channel and stream headers.
This is for convenience, since when writing files the user cares
about how the data is divided into streams, and when reading files most
users will care about how the data is divided into channels.</p>
<ul class="simple">
<li>number (uint32) &#8211; Sequential integer used to uniquely identify each channel in the file; the channel&#8217;s group will be named &#8220;channel[Number]&#8221;.</li>
<li>source (string) &#8211; Device used to produce the channel</li>
<li>acquisition_rate (uint32) &#8211; Acquisition rate in MHz</li>
<li>record_size (uint32) &#8211; Number of samples in each channel record (stream record size = # channels * record size)</li>
<li>data_type_size (uint32) &#8211; Number of bytes used to represent each sample (whether integer or floating point)</li>
<li>data_format_type (uint32) &#8211; Whether the data is analog or digitized<ul>
<li>0 == digitized</li>
<li>1 == analog</li>
</ul>
</li>
<li>bit_depth (uint32) &#8211; Number of bits with which the data was digitized</li>
<li>bit_alignment (uint32) &#8211; Whether the bits within each sample are left-aligned or right-aligned within the sample data word (if the bit depth is less that the data type size)<ul>
<li>0 == left-aligned</li>
<li>1 == right-aligned</li>
</ul>
</li>
<li>voltage_offset (double) &#8211; Voltage value represented by an ADC value of 0 (the minimum voltage for unsigned digital data, and the center voltage for signed digital data)</li>
<li>voltage_range (double) &#8211; Voltage range accepted above the minimum</li>
<li>dac_gain (double) &#8211; Gain value needed to convert digital values to analog (analog = digital * gain + voltage_min)</li>
<li>frequency_min (double) &#8211; For band-pass data, minimum frequency recorded</li>
<li>frequency_range (double) &#8211; For band-pass data, range of frequencies recorded above the minimum</li>
</ul>
</div>
<div class="section" id="acquisitions">
<h2>Acquisitions<a class="headerlink" href="#acquisitions" title="Permalink to this headline">¶</a></h2>
<p>Each stream contains an &#8220;acquisitions&#8221; group that holds the acquisition datasets.
Each acquisition dataset is named simply with the number of the acquisition,
starting from 0 and incrementing for each new acquisition.</p>
<p>Each acquisition has a single attribute:</p>
<ul class="simple">
<li>n_records (uint32) &#8211; Number of records in that acquisition</li>
</ul>
<p>Here are some examples how data might be arranged in an acquisition dataset:</p>
<ul>
<li><p class="first">Single channel; channel record size == 10; 3 records:</p>
<div class="highlight-python"><div class="highlight"><pre>AAAAAAAAAA  &lt;-- record 0
AAAAAAAAAA  &lt;-- record 1
AAAAAAAAAA  &lt;-- record 2
</pre></div>
</div>
</li>
<li><p class="first">Two channels; channel record size == 5; separate samples; 2 records:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">AAAAABBBBB</span>
<span class="n">AAAAABBBBB</span>
</pre></div>
</div>
</li>
<li><p class="first">Three channels; channel record size == 5; interleaved samples; 2 records:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">ABCABCABCABCABC</span>
<span class="n">ABCABCABCABCABC</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="known-issues">
<h2>Known Issues<a class="headerlink" href="#known-issues" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Multi-channel, multi-sample, floating-point data doesn&#8217;t save properly.  A multi-channel RSA might use this format, but we do not currently have such a device.</li>
</ul>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="EggStandard.v3.2.0.html" class="btn btn-neutral float-right" title="Egg v3.2.0 File Standard" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="EggStandard.v3.0.0.html" class="btn btn-neutral" title="Egg v3.0.0 File Standard" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Project 8 Collaboration.
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'3.2.4',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>